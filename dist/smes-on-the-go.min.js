function createMapClickHandler(e,t){var a=document.getElementById(e);a.addEventListener("click",function(){smesMap.changeMapStyle(e),document.getElementById("map-style-name").textContent=t})}function showDrawer(){var e=document.querySelector(".mdl-layout");e&&e.MaterialLayout.drawerToggleHandler_()}function showAbout(){overlayEl&&overlayEl.classList.remove("hidden")}function hideAbout(){overlayEl&&overlayEl.classList.add("hidden")}function clearSearch(){document.getElementById("location-search").value="",document.getElementById("clear-search-div").classList.add("hidden")}function setupMap(){var e={};e.idle=requestMarkInformation,e.zoomChanged=displayZoomMessage,smesMap=new SMESGMap("map",e),markStore=new SMESMarkStore,smesMap.setUpAutoComplete("location-search","clear-search-div"),mobileOS=isMobile(),loadMarks(),displayZoomMessage()}function geoLocate(){smesMap.geoLocate()}function requestMarkInformation(){var e,t;e=smesMap.map.getCenter(),t=smesMap.mapSize||2,showLoader(),console.log("requestMarkInformation"),markStore.requestMarkInformation(e.lat(),e.lng(),t,loadMarks,displayZoomMessage),console.log(markStore.newIndex)}function showLoader(){loader.classList.remove("hidden")}function hideLoader(){loader.classList.add("hidden")}function displayZoomMessage(){var e=smesMap.getZoom();markStore.useLocalStore&&e>=14?zoomInMsg.innerHTML='<span class="zoom-in-message-text">Displaying cached marks - zoom to refresh</span>':zoomInMsg.innerHTML='<span class="zoom-in-message-text">Zoom to display marks</span>',!smesMap.mapSize||smesMap.mapSize>2||14>e||markStore.tooManyMarks?zoomInMsg.classList.remove("hidden"):zoomInMsg.classList.add("hidden"),hideLoader()}function loadMarks(){var e,t,a,r,o;console.log("loadMarks");for(var s='<button id="close-info-box" class="close-button mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"><i class="material-icons">close</i></button>',i='<div class="mdl-card infobox mdl-shadow--3dp overflow-x-visible">',n='<div class="card-content"><div class="card-left">',l='</div><div class="card-value">',d="</div></div>",c=0;c<markStore.newIndex.length;c++){var m={},p={},u={};e=markStore.markData[markStore.newIndex[c]].data,t=markStore.markData[markStore.newIndex[c]].address||"",a=returnMarkType(e),r=""!==mobileOS?'<button id="navigate'+e.nineFigureNumber+'" class="smes-button mdl-button mdl-js-button mdl-js-ripple-effect fade-in">Navigate</button>':"",m.domready=domReadyHandler(e.nineFigureNumber,e.name),m.click=markClickHandler(e.nineFigureNumber,parseFloat(e.latitude),parseFloat(e.longitude)),o=i+'<div class="mdl-card__title mdl-color-text--white"><div class="info-window-header"><div class="section__circle-container"><div class="section__circle-container__circle card-symbol"> <img class="info-symbol" src="symbology/'+a.iconName+'.svg"></div></div><div class="header-text"><div class="nine-figure">'+e.nineFigureNumber+'</div><div><h3 class="mdl-card__title-text">'+e.name+'</h3></div><div class="mark-status">'+a.markDetails+"</div></div></div>"+s+'</div><div class="mdl-card__supporting-text"><div id="address'+e.nineFigureNumber+'"></div><div class="content-section"><div class="content-icon"><i class="material-icons">swap_horiz</i></div><div class="content">'+n+"LL94:"+l+e.latitude+", "+e.longitude+d+n+"MGA:"+l+e.zone+", "+e.easting+", "+e.northing+d+n+"GDA94 technique:"+l+e.gda94Technique+d+n+"Ellipsoid height:"+l+e.ellipsoidHeight+d+n+"Uncertainty:"+l+e.hUncertainty+d+n+"Order:"+l+e.hOrder+d+n+"GDA94 measurements:"+l+e.gda94Measurements+d+'</div></div><div class="vert-spacer"></div><div class="content-section"><div class="content-icon"><i class="material-icons">swap_vert</i></div><div class="content">'+n+"AHD height:"+l+e.ahdHeight+d+n+"AHD technique:"+l+e.ahdTechnique+d+n+"AHD uncertainty:"+l+e.vUncertainty+d+n+"AHD order:"+l+e.vOrder+d+n+"AHD level section:"+l+e.ahdLevelSection+d+'</div></div></div><div id="info-box-loader" class="hidden mdl-progress mdl-js-progress mdl-progress__indeterminate"></div><div class="mdl-card__actions mdl-card--border"><div class="horiz-spacer"></div><button id="sketch'+e.nineFigureNumber+'" class="mdl-button mdl-js-button mdl-js-ripple-effect smes-button fade-in">Sketch</button><button id="report'+e.nineFigureNumber+'" class="mdl-button mdl-js-button mdl-js-ripple-effect smes-button fade-in">Report</button></div></div>',p.lat=e.latitude,p.lng=e.longitude,p.title=e.name,p.icon="symbology/"+a.iconName,p.nineFigureNo=e.nineFigureNumber,p.eventListeners=m,p.infoWindowContent=o,smesMap.addMarker(p),u.lat=e.latitude,u.lng=e.longitude,u.label=e.name,u.nineFigureNo=e.nineFigureNumber,smesMap.addLabel(u)}for(var y=0;y<markStore.updateIndex.length;y++){var f={},g={};e=markStore.markData[markStore.newIndex[y]].data,a=returnMarkType(e),o=i+'<div class="mdl-card__title mdl-color-text--white"><div class="info-window-header"><div class="section__circle-container"><div class="section__circle-container__circle card-symbol"> <img class="info-symbol" src="symbology/'+a.iconName+'.svg"></div></div><div class="header-text"><div class="nine-figure">'+e.nineFigureNumber+'</div><div><h3 class="mdl-card__title-text">'+e.name+'</h3></div><div class="mark-status">'+a.markDetails+"</div></div></div>"+s+'</div><div class="mdl-card__supporting-text"><div id="address'+e.nineFigureNumber+'"></div><div class="content-section"><div class="content-icon"><i class="material-icons">swap_horiz</i></div><div class="content">'+n+"LL94:"+l+e.latitude+", "+e.longitude+d+n+"MGA:"+l+e.zone+", "+e.easting+", "+e.northing+d+n+"GDA94 technique:"+l+e.gda94Technique+d+n+"Ellipsoid height:"+l+e.ellipsoidHeight+d+n+"Uncertainty:"+l+e.hUncertainty+d+n+"Order:"+l+e.hOrder+d+n+"GDA94 measurements:"+l+e.gda94Measurements+d+'</div></div><div class="vert-spacer"></div><div class="content-section"><div class="content-icon"><i class="material-icons">swap_vert</i></div><div class="content">'+n+"AHD height:"+l+e.ahdHeight+d+n+"AHD technique:"+l+e.ahdTechnique+d+n+"AHD uncertainty:"+l+e.vUncertainty+d+n+"AHD order:"+l+e.vOrder+d+n+"AHD level section:"+l+e.ahdLevelSection+d+'</div></div></div><div id="info-box-loader" class="hidden mdl-progress mdl-js-progress mdl-progress__indeterminate"></div><div class="mdl-card__actions mdl-card--border"><div class="horiz-spacer"></div><button id="sketch'+e.nineFigureNumber+'" class="mdl-button mdl-js-button mdl-js-ripple-effect smes-button fade-in">Sketch</button><button id="report'+e.nineFigureNumber+'" class="mdl-button mdl-js-button mdl-js-ripple-effect smes-button fade-in">Report</button></div></div>',f.lat=e.latitude,f.lng=e.longitude,f.title=e.name,f.icon="symbology/"+a.iconName,f.nineFigureNo=e.nineFigureNumber,f.infoWindowContent=o,smesMap.updateMarker(f),g.lat=e.latitude,g.lng=e.longitude,g.label=e.name,g.nineFigureNo=e.nineFigureNumber,smesMap.updateLabel(g)}smesMap.setZoomLevel(),displayZoomMessage()}function markClickHandler(e,t,a){return function(){currentNineFigureNumber=e,currentLatLng.lat=t,currentLatLng.lng=a,zoomInMsg.classList.add("hidden");var r=document.getElementById("address"+e),o="";r&&(o=markStore.returnAddress(currentNineFigureNumber),""!==o?r.innerHTML=o:smesMap.reverseGeocode(currentLatLng.lat,currentLatLng.lng).then(function(e){""!==e&&(r.innerHTML=e,markStore.setAddress(currentNineFigureNumber,e))})),console.log(e)}}function showBoxLoader(){var e=document.getElementById("info-box-loader");e&&e.classList.remove("hidden")}function hideBoxLoader(){var e=document.getElementById("info-box-loader");e&&e.classList.add("hidden")}function domReadyHandler(e,t){var a=t.replace(/  +/g," ");return function(){componentHandler.upgradeAllRegistered(),document.querySelector("[id=sketch"+e+"]").addEventListener("click",function(){console.log("Sketch: "+e),showBoxLoader(),markStore.getSurveyMarkSketchResponse(e).then(function(t){var r=markStore.base64toBlob(t.document,"application/pdf");saveAs(r,a+"("+e+") Sketch.pdf"),hideBoxLoader()})["catch"](function(e){console.log("PDF retrieval failed"),hideBoxLoader()})},!1),document.querySelector("[id=report"+e+"]").addEventListener("click",function(){console.log("Report: "+e),showBoxLoader(),markStore.getSurveyMarkReportResponse(e).then(function(t){var r=markStore.base64toBlob(t.document,"application/pdf");saveAs(r,a+"("+e+") Report.pdf"),hideBoxLoader()})["catch"](function(e){console.log("PDF retrieval failed"),hideBoxLoader()})},!1),""!==mobileOS&&document.querySelector("[id=navigate"+e+"]").addEventListener("click",startNavigation,!1)}}function returnMarkType(e){var t={},a=!1,r=!1,o=!1,s=!1,i=!1,n=o;return"OK"!=e.status?n=!0:("Yes"===e.scn&&(a=!0),""!==e.ahdHeight&&(o=!0),0===String(e.nineFigureNumber).indexOf("1")&&(r=!0),e.gda94Technique.indexOf(scnGDA94Value)>=0&&(s=!0),scnAHDValues.forEach(function(t){e.ahdTechnique.indexOf(t)>=0&&(i=!0)}),n?(t.iconName="defective",t.markDetails="Defective"):n||a||o?n||a||!o?!n&&a&&r?(t.iconName="scn-gda94-pcm",t.markDetails="SCN (GDA94)"):n||!a||o||r?!n&&a&&o&&!s?(t.iconName="scn-ahd-pm",t.markDetails="Non-SCN (GDA94), SCN (AHD)"):!n&&a&&o&&s&&i?(t.iconName="scn-gda94-ahd-pm",t.markDetails="SCN (GDA94), SCN (AHD)"):!n&&a&&o&&s&&!i&&(t.iconName="scn-gda94-ahdapprox-pm",t.markDetails="Non-SCN (GDA94)"):(t.iconName="scn-gda94-pm",t.markDetails="SCN (GDA94)"):(t.iconName="ahdapprox-pm",t.markDetails="Non-SCN (GDA94), non-SCN (AHD)"):(t.iconName="gda94approx-pm",t.markDetails="Non-SCN (GDA94)")),t}function isMobile(){var e=navigator.userAgent;return e.match(/Android/i)?"Android":e.match(/iPhone/i)||e.match(/iPad/i)?"iOS":""}function displayError(){errorMsg.classList.remove("hidden"),errorMsg.textContent="Too many requests have been sent to the server.  Please wait...",window.setTimeout(function(){clearError()},1e3)}function clearError(){errorMsg.classList.add("hidden")}function startNavigation(){if(clearError(),"number"==typeof currentLatLng.lat&&"number"==typeof currentLatLng.lng&&""!==mobileOS){var e;e="Android"===mobileOS?"google.navigation:q="+currentLatLng.lat+","+currentLatLng.lng:"http://maps.apple.com/?daddr="+currentLatLng.lat+","+currentLatLng.lng,window.open(e)}}var SMESMarkStore=function(){"use strict";this.useLocalStore=this.localStorageAvailable(),this.maxRequests=15,this.perNumberOfSeconds=60,this.lastStorageTimeStamp=Date.now(),this.baseURL="https://maps.land.vic.gov.au/lvis/services/smesDataDelivery",this.updateIndex=[],this.newIndex=[],this.tooManyMarks=!1,this.useLocalStore?this.retrieveStoredMarks():this.markData={}};SMESMarkStore.prototype.localStorageAvailable=function(){"use strict";try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(a){return!1}},SMESMarkStore.prototype.retrieveStoredMarks=function(){"use strict";var e,t;if(this.useLocalStore)if(e=window.localStorage.getItem("smes-mark-data")){this.markData=JSON.parse(e),this.markData=this.removeOldMarks(14);for(t in this.markData)this.newIndex.push(t)}else this.markData={}},SMESMarkStore.prototype.clearStoredMarks=function(){"use strict";this.useLocalStore&&window.localStorage.removeItem("smes-mark-data")},SMESMarkStore.prototype.saveMarksToStorage=function(){"use strict";if(this.useLocalStore){var e,t,a=this;a.lastStorageTimeStamp=Date.now(),e=a.lastStorageTimeStamp,window.setTimeout(function(){if(e===a.lastStorageTimeStamp)try{window.localStorage.setItem("smes-mark-data",JSON.stringify(a.markData)),console.log("Data written to local storage")}catch(r){try{JSON.stringify(t).length>5e6&&(t=a.removeOldMarks(7)),JSON.stringify(t).length>5e6&&(t=a.removeOldMarks(7)),window.localStorage.setItem("smes-mark-data",JSON.stringify(t))}catch(r){console.log("Write to local storage failed")}}},2e4)}},SMESMarkStore.prototype.removeOldMarks=function(e){"use strict";var t,a=this.markData;for(t in a)this.isNumberOfDaysOld(a[t].lastUpdated,e)&&delete a[t];return a},SMESMarkStore.prototype.isNumberOfDaysOld=function(e,t){"use strict";var a=new Date(e),r=new Date,o=864e5,s=r.getTime()-a.getTime(),i=Math.floor(s/o);return i>=t?!0:!1},SMESMarkStore.prototype.delayNextRequest=function(){"use strict";var e=this;e.lastSuccesfullRetrieve=Date.now()+2e4},SMESMarkStore.prototype.requestMarkInformation=function(e,t,a,r,o){"use strict";var s=this,i=new Date,n=500;if(!(a>2)){s.lastQueuedTimeStamp=i;var l=s.perNumberOfSeconds/s.maxRequests*1e3;if(s.lastSuccesfullRetrieve){var d=i-s.lastSuccesfullRetrieve;l>d&&(n=l-d+n)}window.setTimeout(function(){i===s.lastQueuedTimeStamp?(console.log("Processing request"),s.lastSuccesfullRetrieve=new Date,s.retrieveMarkInformation(e,t,a).then(function(e){e&&s.processRetrievedMarks(e).then(function(){console.log("Executing callback"),s.tooManyMarks=!1,r.apply(this)})})["catch"](function(e){"Too many marks"===e&&(s.tooManyMarks=!0,o.apply(this)),console.log(e)})):console.log("Dropping request - newer request has arrived")},n)}},SMESMarkStore.prototype.processRetrievedMarks=function(e){"use strict";var t,a,r=this;return new Promise(function(o,s){r.updateIndex=[],r.newIndex=[];for(var i=0;i<e.length;i++)t=e[i],r.markData[t.nineFigureNumber]?r.isNumberOfDaysOld(r.markData[t.nineFigureNumber].lastUpdated||0,1)&&(a=r.calculateDataHash(t),a!==r.markData[t.nineFigureNumber].dataHash?(r.addUpdateValueInStore(t,a),r.updateIndex.push(t.nineFigureNumber)):r.markData[t.nineFigureNumber].lastUpdated=Date.now()):(a=r.calculateDataHash(t),r.addUpdateValueInStore(t,a),r.newIndex.push(t.nineFigureNumber));o(!0),r.saveMarksToStorage()})},SMESMarkStore.prototype.countMarks=function(){"use strict";var e,t=this,a=0;for(e in t.markData)a+=1;return a},SMESMarkStore.prototype.calculateDataHash=function(e){"use strict";var t,a;a="";for(t in e)a+=e[t];return a},SMESMarkStore.prototype.addUpdateValueInStore=function(e,t){"use strict";this.markData[e.nineFigureNumber]||(this.markData[e.nineFigureNumber]={}),this.markData[e.nineFigureNumber].data=e,this.markData[e.nineFigureNumber].dataHash=t,delete this.markData[e.nineFigureNumber].address,this.markData[e.nineFigureNumber].lastUpdated=Date.now()},SMESMarkStore.prototype.setAddress=function(e,t){"use strict";this.markData[e].address=t},SMESMarkStore.prototype.returnAddress=function(e){"use strict";var t=this.markData[e]||null;return t.address||""},SMESMarkStore.prototype.retrieveMarkInformation=function(e,t,a){"use strict";var r=this;return new Promise(function(o,s){fetch(r.baseURL+"/getMarkInformation?searchType=Location&latitude="+e+"&longitude="+t+"&radius="+a+"&format=Full",{mode:"cors"}).then(function(e){return e.json()}).then(function(e){"undefined"==typeof e.messages?o(e.data):"More than 250 marks were found for this search. Please refine your search criteria."===e.messages.message?(console.log("Too many marks"),s("Too many marks")):"No survey marks matched the criteria provided."===e.messages.message?(console.log("No marks found"),s("No marks found")):(console.log(e.messages.message),s("Webservice error"))})["catch"](function(e){return console.log(e),r.delayNextRequest(),console.log("Too many requests"),Promise.reject(e)})})},SMESMarkStore.prototype.getSurveyMarkSketchResponse=function(e){"use strict";var t=this;return new Promise(function(a,r){fetch(t.baseURL+"/getSurveyMarkSketches?returnDefective=true&markList="+e,{mode:"cors"}).then(function(e){return e.json()}).then(function(e){"undefined"==typeof e.messages?a(e.data):(console.log(e.messages.message),r("Webservice error"))})["catch"](function(e){return console.log(e),Promise.reject(e)})})},SMESMarkStore.prototype.getSurveyMarkReportResponse=function(e){"use strict";var t=this;return new Promise(function(a,r){fetch(t.baseURL+"/getSurveyMarkReports?returnDefective=true&markList="+e,{mode:"cors"}).then(function(e){return e.json()}).then(function(e){"undefined"==typeof e.messages?a(e.data):(console.log(e.messages.message),r("Webservice error"))})["catch"](function(e){return console.log(),Promise.reject(e)})})},SMESMarkStore.prototype.base64toBlob=function(e,t,a){"use strict";t=t||"",a=a||512;for(var r=atob(e),o=[],s=0;s<r.length;s+=a){for(var i=r.slice(s,s+a),n=new Array(i.length),l=0;l<i.length;l++)n[l]=i.charCodeAt(l);var d=new Uint8Array(n);o.push(d)}var c=new Blob(o,{type:t});return c};var SMESGMap=function(e,t){"use strict";var a=new google.maps.LatLng(-37.813942,144.9711861);this.setupMapStyles(),t=t||{},t.mapOptions=t.mapOptions||{center:a,zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},panControl:!1,rotateControl:!1,styles:this.mapStyles.iovation},this.mapOptions=t.mapOptions,this.markers=[],this.labels=[],this.currentZoom=1,this.markerIcons=[],this.markerSize=10,this.markersHidden=!1,this.map=new google.maps.Map(document.getElementById(e),this.mapOptions),this.geocoder=new google.maps.Geocoder,this.infoWindow=new google.maps.InfoWindow,this.infoBox=new InfoBox({content:document.getElementById("infobox"),disableAutoPan:!1,maxWidth:440,pixelOffset:new google.maps.Size(-220,0),zIndex:25,closeBoxURL:"",infoBoxClearance:new google.maps.Size(4,4)}),this.getMapPreference();var r=this;google.maps.event.addListener(r.map,"zoom_changed",function(){r.checkSizeofMap(),r.setZoomLevel()}),"function"==typeof t.zoomChanged&&google.maps.event.addListener(r.map,"zoom_changed",function(e){void 0===e&&(e=r),t.zoomChanged.apply(r,[e])}),google.maps.event.addListener(r.map,"idle",function(){r.resizeIcons()}),"function"==typeof t.idle&&google.maps.event.addListener(r.map,"idle",function(e){void 0===e&&(e=r),t.idle.apply(r,[e])});var o=r.infoBox;google.maps.event.addListener(o,"domready",function(){var e=document.getElementById("close-info-box");e&&e.addEventListener("click",function(){o.setVisible(!1),r.resetSelectedMarker()})}),r.geoLocate(),r.resizeInfoBox(),window.onresize=r.resizeInfoBox()};SMESGMap.prototype.resizeInfoBox=function(){"use strict";var e=this,t=window.innerWidth,a=e.infoBox.maxWidth_;(440>t||440>a)&&t!==a&&(t>440&&(t=440),e.infoBox.setOptions({maxWidth:t,pixelOffset:new google.maps.Size(t*-.5,0)}))},SMESGMap.prototype.localStorageAvailable=function(){"use strict";try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(a){return!1}},SMESGMap.prototype.getMapPreference=function(){"use strict";var e,t=this;t.localStorageAvailable&&(e=window.localStorage.getItem("map-style"),e&&(t.changeMapStyle(e),t.mapStyleName=e))},SMESGMap.prototype.saveStylePreference=function(e){"use strict";if(this.localStorageAvailable)try{window.localStorage.setItem("map-style",e)}catch(t){console.log("Write to local storage failed")}},SMESGMap.prototype.geoLocate=function(){"use strict";var e=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){var a=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);e.map.setCenter(a)},function(e){console.log(e)})},SMESGMap.prototype.getZoom=function(){"use strict";return this.map.getZoom()},SMESGMap.prototype.addMarker=function(e){"use strict";var t,a,r,o,s,i,n,l=this;t=e.lat,a=e.lng,r=e.title,o=e.icon,s=e.nineFigureNo,i=e.infoWindowContent,n=e.eventListeners||null;var d={url:o+".svg",size:new google.maps.Size(l.markerSize,l.markerSize),scaledSize:new google.maps.Size(l.markerSize,l.markerSize)},c=new google.maps.Marker({position:new google.maps.LatLng(t,a),title:r,map:l.map,draggable:!1,icon:d,animation:google.maps.Animation.DROP,infoContent:i,nineFigureNo:s});c.addListener("click",function(){var e=document.getElementById("infobox");e.innerHTML=c.infoContent,l.setSelectedMarker(c),l.infoBox.open(l.map,this),l.infoBox.setVisible(!0),l.map.panTo(c.position),n&&n.click&&n.click.apply(),n&&n.domready&&window.setTimeout(function(){n.domready.apply(this)},0)}),l.markers.push(c),l.markersHidden&&c.setMap(null)},SMESGMap.prototype.updateMarker=function(e){"use strict";var t,a,r,o,s,i,n,l,d=this;t=e.lat,a=e.lng,r=e.title,o=e.icon,s=e.nineFigureNo,i=e.infoWindowContent;for(var c=0;c<d.markers.length;c++)if(d.markers[c].nineFigureNo===s){n=d.markers[c];break}n&&(l={url:o+".svg",size:new google.maps.Size(d.markerSize,d.markerSize),scaledSize:new google.maps.Size(d.markerSize,d.markerSize)},n.setIcon(l),n.setPosition(new google.maps.LatLng(t,a)),n.setTitle(r),n.infoContent=i);for(var m=0;m<d.markers.length;m++)if(d.markers[m].nineFigureNo===s){d.markers.splice(m,1);break}},SMESGMap.prototype.setSelectedMarker=function(e){"use strict";var t,a=this,r=e.icon,o=r.url;a.resetSelectedMarker(),o=o.replace("selected-","");var s=o.lastIndexOf("/");o=o.substr(0,s+1)+"selected-"+o.substr(s+1),t=2*a.markerSize,r.scaledSize=new google.maps.Size(t,t),r.size=new google.maps.Size(t,t),r.url=o,e.setIcon(r),e.isSelected=!0},SMESGMap.prototype.resetSelectedMarker=function(){"use strict";for(var e,t,a=this,r=0;r<a.markers.length;r++)a.markers[r].isSelected&&(e=a.markers[r].icon,t=e.url,t=t.replace("selected-",""),e.scaledSize=new google.maps.Size(a.markerSize,a.markerSize),e.size=new google.maps.Size(a.markerSize,a.markerSize),e.url=t,a.markers[r].setIcon(e),delete a.markers[r].isSelected)},SMESGMap.prototype.addLabel=function(e){"use strict";var t,a,r,o,s=this;r=e.lat,o=e.lng,t=e.label,a=e.nineFigureNo;var i=new MapLabel({text:t,position:new google.maps.LatLng(r,o),map:s.map,minZoom:19,fontFamily:"'Muli', sans-serif",strokeWeight:6,fontColor:"rgba(28, 43, 139, 0.87)",strokeColor:"rgba(245, 245, 245, 0.87)",fontSize:12,align:"center",nineFigureNo:a});s.labels.push(i)},SMESGMap.prototype.updateLabel=function(e){"use strict";var t,a,r,o,s,i=this;r=e.lat,o=e.lng,t=e.label,a=e.nineFigureNo;for(var n=0;n<i.labels.length;n++)if(i.labels[n].nineFigureNo===a){s=i.labels[n];break}s&&(s.set("text",t),s.set("position",new google.maps.LatLng(r,o)))},SMESGMap.prototype.setZoomLevel=function(){"use strict";var e=this,t=this.map.getZoom();e.zoomLevel&&e.zoomLevel===t||(14>t&&(!e.zoomLevel||e.zoomLevel>=14)?(e.hideMarkers(),e.markersHidden=!0):t>=14&&(!e.zoomLevel||e.zoomLevel<14)&&e.showMarkers(),t>=14&&(e.markerResizeRequired=!0,e.markersHidden=!1)),e.zoomLevel=e.map.getZoom(),e.markerSize=9+1.75*(e.zoomLevel-14)},SMESGMap.prototype.resizeIcons=function(){"use strict";for(var e,t,a=this,r=0;r<a.markers.length;r++)e=a.markers[r].icon,t=a.markerSize||14,a.markers[r].isSelected&&(t=2*t),e.scaledSize=new google.maps.Size(t,t),e.size=new google.maps.Size(t,t),a.markers[r].setIcon(e)},SMESGMap.prototype.hideMarkers=function(){"use strict";for(var e=this,t=0;t<e.markers.length;t++)e.markers[t].setMap(null)},SMESGMap.prototype.showMarkers=function(){"use strict";for(var e=this,t=0;t<e.markers.length;t++)e.markers[t].setMap(e.map)},SMESGMap.prototype.hideLabels=function(){"use strict";for(var e=this,t=0;t<e.labels.length;t++)e.labels[t].set("map","null")},SMESGMap.prototype.showLabels=function(){"use strict";for(var e=this,t=0;t<e.labels.length;t++)e.labels[t].set("map",e.map)},SMESGMap.prototype.reverseGeocode=function(e,t){"use strict";return new Promise(function(a,r){var o={lat:e,lng:t};this.geocoder.geocode({location:o},function(e,t){t===google.maps.GeocoderStatus.OK?a(e[0]?e[0].formatted_address:""):(console.log("Geocoder failed due to: "+t),r("Geocoder failed due to: "+t))})})},SMESGMap.prototype.setUpAutoComplete=function(e,t){"use strict";var a=this,r=document.getElementById(e),o=new google.maps.InfoWindow,s=document.getElementById(t),i=new google.maps.Marker({map:a.map,anchorPoint:new google.maps.Point(0,-29)});a.autoComplete=new google.maps.places.Autocomplete(r),a.autoComplete.bindTo("bounds",a.map),r.addEventListener("input",function(){r.classList.remove("not-found"),""===r.value?s.classList.add("hidden"):s.classList.remove("hidden")}),a.autoComplete.addListener("place_changed",function(){o.close(),i.setVisible(!1);var e=a.autoComplete.getPlace();if(!e.geometry)return void r.classList.add("not-found");r.classList.remove("not-found"),e.geometry.viewport?a.map.fitBounds(e.geometry.viewport):(a.map.setCenter(e.geometry.location),a.map.setZoom(17)),i.setPosition(e.geometry.location),i.setVisible(!0);var t="";e.address_components&&(t=[e.address_components[0]&&e.address_components[0].short_name||"",e.address_components[1]&&e.address_components[1].short_name||"",e.address_components[2]&&e.address_components[2].short_name||""].join(" ")),o.setContent("<div><strong>"+e.name+"</strong><br>"+t+"</div>"),o.open(a.map,i)}),i.addListener("click",function(){o.open(a.map,i)})},SMESGMap.prototype.checkSizeofMap=function(){"use strict";var e=this.map.getBounds().getSouthWest(),t=this.map.getCenter(),a=this;if("undefined"!=typeof e&&"undefined"!=typeof t){var r=a.getDistanceKms(t.lat(),t.lng(),e.lat(),e.lng());a.mapSize=r/1e3}else a.mapSize=0},SMESGMap.prototype.getDistanceKms=function(e,t,a,r){"use strict";var o=this,s=6378137,i=o.calcRad(a-e),n=o.calcRad(r-t),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(o.calcRad(e))*Math.cos(o.calcRad(a))*Math.sin(n/2)*Math.sin(n/2),d=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),c=s*d;return c},SMESGMap.prototype.calcRad=function(e){"use strict";return e*Math.PI/180},SMESGMap.prototype.changeMapStyle=function(e){"use strict";var t,a=this;a.mapStyleName=e,"google"!==e&&a.mapStyles[e]&&(t=a.mapStyles[e]),a.map.setOptions({styles:t}),a.saveStylePreference(e)},SMESGMap.prototype.setupMapStyles=function(){"use strict";this.mapStyles={coolgrey:[{featureType:"landscape",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{stylers:[{hue:"#00aaff"},{saturation:-100},{gamma:2.15},{lightness:12}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{visibility:"on"},{lightness:24}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:57}]}],darkgrey:[{featureType:"landscape",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",stylers:[{saturation:-100},{lightness:51},{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"road.arterial",stylers:[{saturation:-100},{lightness:30},{visibility:"on"}]},{featureType:"road.local",stylers:[{saturation:-100},{lightness:40},{visibility:"on"}]},{featureType:"transit",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"administrative.province",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"on"},{lightness:-25},{saturation:-100}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#ffff00"},{lightness:-25},{saturation:-97}]}],paledawn:[{featureType:"administrative",elementType:"all",stylers:[{visibility:"on"},{lightness:33}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2e5d4"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#c5dac6"}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"on"},{lightness:20}]},{featureType:"road",elementType:"all",stylers:[{lightness:20}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#c5c6c6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#e4d7c6"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#fbfaf7"}]},{featureType:"water",elementType:"all",stylers:[{visibility:"on"},{color:"#acbcc9"}]}],shiftworker:[{stylers:[{saturation:-100},{gamma:1}]},{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"on"},{saturation:50},{gamma:0},{hue:"#50a5d1"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#333333"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{weight:.5},{color:"#333333"}]},{featureType:"transit.station",elementType:"labels.icon",stylers:[{gamma:1},{saturation:50}]}],simplelight:[{featureType:"administrative",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"landscape",elementType:"geometry",stylers:[{visibility:"simplified"},{color:"#fcfcfc"}]},{featureType:"poi",elementType:"geometry",stylers:[{visibility:"simplified"},{color:"#fcfcfc"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"simplified"},{color:"#dddddd"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{visibility:"simplified"},{color:"#dddddd"}]},{featureType:"road.local",elementType:"geometry",stylers:[{visibility:"simplified"},{color:"#eeeeee"}]},{featureType:"water",elementType:"geometry",stylers:[{visibility:"simplified"},{color:"#dddddd"}]}],muted:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"administrative.locality",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"},{visibility:"simplified"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi",elementType:"geometry",stylers:[{visibility:"simplified"},{saturation:"-65"},{lightness:"45"},{gamma:"1.78"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{saturation:"-33"},{lightness:"22"},{gamma:"2.08"}]},{featureType:"transit.station.airport",elementType:"geometry",stylers:[{gamma:"2.08"},{hue:"#ffa200"}]},{featureType:"transit.station.airport",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.station.rail",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"transit.station.rail",elementType:"labels.icon",stylers:[{visibility:"simplified"},{saturation:"-55"},{lightness:"-2"},{gamma:"1.88"},{hue:"#ffab00"}]},{featureType:"water",elementType:"all",stylers:[{color:"#bbd9e5"},{visibility:"simplified"}]}],iovation:[{featureType:"all",elementType:"geometry",stylers:[{gamma:"0.82"}]},{featureType:"all",elementType:"geometry.fill",stylers:[{gamma:"1.21"}]},{featureType:"all",elementType:"labels",stylers:[{lightness:"-60"}]},{featureType:"all",elementType:"labels.text",stylers:[{gamma:"5.37"}]},{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#419d8c"},{lightness:"-39"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#fefefe"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#fefefe"},{lightness:17},{weight:1.2}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:20}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{saturation:"0"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:21}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#dedede"
},{lightness:21}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#ffffff"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:16}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#f2f2f2"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#e9e9e9"},{lightness:17}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#42738d"},{gamma:"5.37"}]}],ultralight:[{featureType:"water",elementType:"geometry",stylers:[{color:"#e9e9e9"},{lightness:17}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:20}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#ffffff"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:16}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:21}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#dedede"},{lightness:21}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"},{lightness:16}]},{elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#333333"},{lightness:40}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#f2f2f2"},{lightness:19}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#fefefe"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#fefefe"},{lightness:17},{weight:1.2}]}]}};var loader,locateButton,zoomInMsg,errorMsg,mobileOS,elTimer,overlayEl,smesMap,markStore,scnAHDValues=["ZEROTH ORDER","2ND ORDER","3RD ORDER","SPIRIT LEVELLING"],scnGDA94Value="ADJUSTMENT",pcmSearchText="PCM",currentNineFigureNumber,currentLatLng={},currentRadius;window.addEventListener("load",function(e){loader=document.querySelector("[id=loader]"),zoomInMsg=document.querySelector("[id=zoom-in-msg]"),errorMsg=document.querySelector("[id=error-msg]"),locateButton=document.querySelector("[id=locate]"),locateButton.addEventListener("click",geoLocate,!1),document.getElementById("hamburger-menu").addEventListener("click",showDrawer,!1),document.getElementById("clear-search").addEventListener("click",clearSearch,!1),document.getElementById("nav-about").addEventListener("click",showAbout,!1),document.getElementById("about-OK").addEventListener("click",hideAbout,!1),overlayEl=document.getElementById("screen-overlay"),setupMap();for(var t=document.getElementById("style-option-list"),a=0;a<t.childNodes.length;a++)1===t.childNodes[a].nodeType&&createMapClickHandler(t.childNodes[a].id,t.childNodes[a].textContent),smesMap.mapStyleName&&smesMap.mapStyleName===t.childNodes[a].id&&(document.getElementById("map-style-name").textContent=t.childNodes[a].textContent);geoLocate()},!1);